define(["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createVirtualLanguageServiceHost=t.createVirtualCompilerHost=t.createFSBackedSystem=t.createSystem=t.createDefaultMapFromCDN=t.addFilesForTypesIntoFolder=t.addAllFilesFromFolder=t.createDefaultMapFromNodeModules=t.knownLibFilesForCompilerOptions=t.createVirtualTypeScriptEnvironment=void 0;let s=!1;try{s="undefined"!=typeof localStorage}catch(e){}const r="undefined"!=typeof process,i=s&&localStorage.getItem("DEBUG")||r&&process.env.DEBUG?console.log:(e,...t)=>"";function o(e){throw new Error(`Method '${e}' is not implemented.`)}function l(e,t){return(...s)=>{const r=t(...s),o="string"==typeof r?r.slice(0,80)+"...":r;return i("> "+e,...s),i("< "+o),r}}t.createVirtualTypeScriptEnvironment=function(e,t,s,r={},i){const o=Object.assign(Object.assign({},n(s)),r),{languageServiceHost:l,updateFile:a}=d(e,t,o,s,i),u=s.createLanguageService(l),p=u.getCompilerOptionsDiagnostics();if(p.length){const t=c(e,r,s);throw new Error(s.formatDiagnostics(p,t.compilerHost))}return{name:"vfs",sys:e,languageService:u,getSourceFile:e=>{var t;return null===(t=u.getProgram())||void 0===t?void 0:t.getSourceFile(e)},createFile:(e,t)=>{a(s.createSourceFile(e,t,o.target,!1))},updateFile:(e,t,r)=>{const i=u.getProgram().getSourceFile(e);if(!i)throw new Error("Did not find a source file for "+e);const o=i.text,l=null!=r?r:s.createTextSpan(0,o.length),n=o.slice(0,l.start)+t+o.slice(l.start+l.length),c=s.updateSourceFile(i,n,{span:l,newLength:t.length});a(c)}}},t.knownLibFilesForCompilerOptions=(e,t)=>{const s=e.target||t.ScriptTarget.ES5,r=e.lib||[],i=["lib.d.ts","lib.dom.d.ts","lib.dom.iterable.d.ts","lib.webworker.d.ts","lib.webworker.importscripts.d.ts","lib.scripthost.d.ts","lib.es5.d.ts","lib.es6.d.ts","lib.es2015.collection.d.ts","lib.es2015.core.d.ts","lib.es2015.d.ts","lib.es2015.generator.d.ts","lib.es2015.iterable.d.ts","lib.es2015.promise.d.ts","lib.es2015.proxy.d.ts","lib.es2015.reflect.d.ts","lib.es2015.symbol.d.ts","lib.es2015.symbol.wellknown.d.ts","lib.es2016.array.include.d.ts","lib.es2016.d.ts","lib.es2016.full.d.ts","lib.es2017.d.ts","lib.es2017.full.d.ts","lib.es2017.intl.d.ts","lib.es2017.object.d.ts","lib.es2017.sharedmemory.d.ts","lib.es2017.string.d.ts","lib.es2017.typedarrays.d.ts","lib.es2018.asyncgenerator.d.ts","lib.es2018.asynciterable.d.ts","lib.es2018.d.ts","lib.es2018.full.d.ts","lib.es2018.intl.d.ts","lib.es2018.promise.d.ts","lib.es2018.regexp.d.ts","lib.es2019.array.d.ts","lib.es2019.d.ts","lib.es2019.full.d.ts","lib.es2019.object.d.ts","lib.es2019.string.d.ts","lib.es2019.symbol.d.ts","lib.es2020.d.ts","lib.es2020.full.d.ts","lib.es2020.string.d.ts","lib.es2020.symbol.wellknown.d.ts","lib.es2020.bigint.d.ts","lib.es2020.promise.d.ts","lib.es2020.sharedmemory.d.ts","lib.es2020.intl.d.ts","lib.es2021.d.ts","lib.es2021.full.d.ts","lib.es2021.promise.d.ts","lib.es2021.string.d.ts","lib.es2021.weakref.d.ts","lib.esnext.d.ts","lib.esnext.full.d.ts","lib.esnext.intl.d.ts","lib.esnext.promise.d.ts","lib.esnext.string.d.ts","lib.esnext.weakref.d.ts"],o=t.ScriptTarget[s],l=i.filter((e=>e.startsWith(`lib.${o.toLowerCase()}`))),n=i.indexOf(l.pop()),a=r.map((e=>{const t=i.filter((t=>t.startsWith(`lib.${e.toLowerCase()}`)));return 0===t.length?0:i.indexOf(t.pop())})),c=((d=a)&&d.length?d.reduce(((e,t)=>t>e?t:e)):void 0)||0;var d;const u=Math.max(n,c);return i.slice(0,u+1)},t.createDefaultMapFromNodeModules=(s,r,i)=>{const o=r||e("typescript"),l=u(),n=p(),a=(0,t.knownLibFilesForCompilerOptions)(s,o),c=new Map;return a.forEach((t=>{c.set("/"+t,(t=>{const s=i||l.dirname(e.resolve("typescript"));return n.readFileSync(l.join(s,t),"utf8")})(t))})),c},t.addAllFilesFromFolder=(e,t)=>{const s=u(),r=p(),i=function(e){let t=[];return r.readdirSync(e).forEach((function(o){o=s.join(e,o);const l=r.statSync(o);l&&l.isDirectory()?t=t.concat(i(o)):t.push(o)})),t};i(t).forEach((i=>{const o="/node_modules/@types"+i.replace(t,""),l=r.readFileSync(i,"utf8");[".ts",".tsx"].includes(s.extname(o))&&e.set(o,l)}))},t.addFilesForTypesIntoFolder=e=>(0,t.addAllFilesFromFolder)(e,"node_modules/@types"),t.createDefaultMapFromCDN=(e,s,r,i,o,l,n)=>{const a=l||fetch,c=new Map,d=(0,t.knownLibFilesForCompilerOptions)(e,i),u=`https://typescript.azureedge.net/cdn/${s}/typescript/lib/`;return(r?function(){const e=n||localStorage;return Object.keys(localStorage).forEach((t=>{t.startsWith("ts-lib-")&&!t.startsWith("ts-lib-"+s)&&e.removeItem(t)})),Promise.all(d.map((t=>{const r=`ts-lib-${s}-${t}`,i=e.getItem(r);return i?Promise.resolve((l=i,o?o.decompressFromUTF16(l):l)):a(u+t).then((e=>e.text())).then((t=>{var s;return e.setItem(r,(s=t,o?o.compressToUTF16(s):s)),t}));var l}))).then((e=>{e.forEach(((e,t)=>{const s="/"+d[t];c.set(s,e)}))}))}:function(){return Promise.all(d.map((e=>a(u+e).then((e=>e.text()))))).then((e=>{e.forEach(((e,t)=>c.set("/"+d[t],e)))}))})().then((()=>c))};const n=e=>Object.assign(Object.assign({},e.getDefaultCompilerOptions()),{jsx:e.JsxEmit.React,strict:!0,esModuleInterop:!0,module:e.ModuleKind.ESNext,suppressOutputPathCheck:!0,skipLibCheck:!0,skipDefaultLibCheck:!0,moduleResolution:e.ModuleResolutionKind.NodeJs}),a=e=>e.replace("/","/lib.").toLowerCase();function c(e,t,s){const r=new Map;return{compilerHost:Object.assign(Object.assign({},e),{getCanonicalFileName:e=>e,getDefaultLibFileName:()=>"/"+s.getDefaultLibFileName(t),getDirectories:()=>[],getNewLine:()=>e.newLine,getSourceFile:i=>{return r.get(i)||(o=s.createSourceFile(i,e.readFile(i),t.target||n(s).target,!1),r.set(o.fileName,o),o);var o},useCaseSensitiveFileNames:()=>e.useCaseSensitiveFileNames}),updateFile:t=>{const s=r.has(t.fileName);return e.writeFile(t.fileName,t.text),r.set(t.fileName,t),s}}}function d(e,t,s,r,i){const o=[...t],{compilerHost:l,updateFile:n}=c(e,s,r),a=new Map;let d=0;return{languageServiceHost:Object.assign(Object.assign({},l),{getProjectVersion:()=>d.toString(),getCompilationSettings:()=>s,getCustomTransformers:()=>i,getScriptFileNames:()=>o.slice(),getScriptSnapshot:t=>{const s=e.readFile(t);if(s)return r.ScriptSnapshot.fromString(s)},getScriptVersion:e=>a.get(e)||"0",writeFile:e.writeFile}),updateFile:e=>{d++,a.set(e.fileName,d.toString()),o.includes(e.fileName)||o.push(e.fileName),n(e)}}}t.createSystem=function(e){return{args:[],createDirectory:()=>o("createDirectory"),directoryExists:l("directoryExists",(t=>Array.from(e.keys()).some((e=>e.startsWith(t))))),exit:()=>o("exit"),fileExists:l("fileExists",(t=>e.has(t)||e.has(a(t)))),getCurrentDirectory:()=>"/",getDirectories:()=>[],getExecutingFilePath:()=>o("getExecutingFilePath"),readDirectory:l("readDirectory",(t=>"/"===t?Array.from(e.keys()):[])),readFile:l("readFile",(t=>e.get(t)||e.get(a(t)))),resolvePath:e=>e,newLine:"\n",useCaseSensitiveFileNames:!0,write:()=>o("write"),writeFile:(t,s)=>{e.set(t,s)}}},t.createFSBackedSystem=function(t,s,r,i){const n=s+"/vfs",a=u(),c=r.sys,d=null!=i?i:a.dirname(e.resolve("typescript"));return{name:"fs-vfs",root:n,args:[],createDirectory:()=>o("createDirectory"),directoryExists:l("directoryExists",(e=>Array.from(t.keys()).some((t=>t.startsWith(e)))||c.directoryExists(e))),exit:c.exit,fileExists:l("fileExists",(e=>{if(t.has(e))return!0;if(e.includes("tsconfig.json")||e.includes("tsconfig.json"))return!1;if(e.startsWith("/lib")){const t=`${d}/${e.replace("/","")}`;return c.fileExists(t)}return c.fileExists(e)})),getCurrentDirectory:()=>n,getDirectories:c.getDirectories,getExecutingFilePath:()=>o("getExecutingFilePath"),readDirectory:l("readDirectory",((...e)=>"/"===e[0]?Array.from(t.keys()):c.readDirectory(...e))),readFile:l("readFile",(e=>{if(t.has(e))return t.get(e);if(e.startsWith("/lib")){const t=`${d}/${e.replace("/","")}`,s=c.readFile(t);if(!s){const e=c.readDirectory(d);throw new Error(`TSVFS: A request was made for ${t} but there wasn't a file found in the file map. You likely have a mismatch in the compiler options for the CDN download vs the compiler program. Existing Libs: ${e}.`)}return s}return c.readFile(e)})),resolvePath:e=>t.has(e)?e:c.resolvePath(e),newLine:"\n",useCaseSensitiveFileNames:!0,write:()=>o("write"),writeFile:(e,s)=>{t.set(e,s)}}},t.createVirtualCompilerHost=c,t.createVirtualLanguageServiceHost=d;const u=()=>e(String.fromCharCode(112,97,116,104)),p=()=>e(String.fromCharCode(102,115))}));